---
title: 'Blog Post number 1'
date: 2023-06-21
permalink: /posts/2013/06/blog-post-1/
tags:
  - Pytorch
  - C++
---

Running Pytorch in C++
======
Running Pytorch in C++ is very cool~~

Most of the people use Pytorch in python to build up the Convolutional Neural Network (CNN) model, such as in Jupyter Notebook. It is the most common and a faster way to do so. But if we want to make a hardware acceleration to speed up the performance, like using [Vitis HLS](https://www.xilinx.com/products/design-tools/vitis/vitis-hls.html) from Xilinx, python is not suitable because it only supports C/C++. Hence, we may rebuild our CNN model in C++ with the aid of Pytorch which can make our live more easier. As a result, we can accelerate the algorithm using the concepts like pipeline and loop unrolling from Vitis HLS. 

This tutorial will show you how to load Pytorch library into C++ under the [Visual Studio Code](https://code.visualstudio.com/) in macOS Catalina version 10.15.7 environment. 

Prerequsite:
You should have install Pytorch in your environment already. 

Step1:

Open terminal and run the following cmd to print put the location path of your Pytorch. And remember to store the location first.
python -c 'import torch; print(torch.utils.cmake_prefix_path)'

Step2:

Navigate to the directory containing your main.cpp (your .cpp file that build the CNN model)

Step3:

Create a file called CMakeLists.txt and paste the the following codes in and save it.


#########################################################
cmake_minimum_required(VERSION 3.0 FATAL_ERROR)
project(example-app)

find_package(Torch REQUIRED)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${TORCH_CXX_FLAGS}")

add_executable(main main.cpp)
target_link_libraries(main "${TORCH_LIBRARIES}")
set_property(TARGET main PROPERTY CXX_STANDARD 14)
#########################################################


Step4:

Back to the terminal in Step1, type in the following cmd sequentially.
mkdir build
cd build
cmake -DCMAKE_PREFIX_PATH=[paste your pathway that you stored in Step1]
cmake --build . --config Release

Step5:

Done! 
You may run the output file to see the result by cmd
./main

Hope you enjoy this :)

Reference:
[https://www.youtube.com/watch?v=IVWpv-610h4](https://www.youtube.com/watch?v=IVWpv-610h4)

[https://pytorch.org/tutorials/advanced/cpp_frontend.html](https://pytorch.org/tutorials/advanced/cpp_frontend.html)
